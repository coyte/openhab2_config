import java.util.String
var tuyaScript = "node /etc/openhab2/scripts/njstuya.js "

rule "tuyaStatus"
when
    //Item ruleTrigger changed
    //Time cron "0 0/1 * 1/1 * ? *"
then
	logInfo("rules","TuyaStatus -- Rule starting")
    gTuya.members.forEach [ item | {
        if (item.name.substring(item.name.length()-7) == "_config") {
            val idstring = item.name.substring(0,9)
            //logInfo("rules", "tuyaStatus -- Activiteit voor config item")
            val configStr = item.label
            var String tuyaState
            tuyaState = executeCommandLine(tuyaScript + configStr, 50000)
            logInfo("rules", "tuyaStatus - Status "+ idstring +": " + tuyaState)
            idstring.postUpdate(tuyaState)
        }
    } ]
end

